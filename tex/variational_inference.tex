\documentclass{article}
\usepackage{algpseudocode}
\usepackage{algorithm}
\begin{document}
\begin{algorithm}
   \caption{Variational Inference}
   \begin{algorithmic}[1]
   
      \Function{optimize-zeta}{$\lambda, \nu^2$}
      \State \Return $\sum{}{e^{\lambda + \frac{1}{2}\nu^2}}$
      \EndFunction
      
      \Function{optimize-lambda}{$\lambda, \nu^2$}
    	  \Function{objective-lambda}{params}
		      \State\Return 
	      \EndFunction
     	  \Function{objective-lambda-gradient}{params}
		      \State\Return 
	      \EndFunction
	  \State $\lambda\gets $ result from a SciPy optimizer using functions \Call{objective-lambda}{} and \Call{objective-lambda-gradient}{}
      \State \Return $\lambda$
      \EndFunction
      
      \Function{optimize-nu-sq}{$\lambda, \nu^2$}
    	  \Function{objective-nu-sq}{params}
		      \State\Return 
	      \EndFunction
     	  \Function{objective-nu-sq-gradient}{params}
		      \State\Return 
	      \EndFunction
	  \State $\nu^2\gets $ result from a SciPy optimizer using functions \Call{objective-nu-sq}{} and \Call{objective-nu-sq-gradient}{}
      \State \Return $\nu^2$
      \EndFunction
      
      \Function{optimize-phi}{$\lambda, \nu^2$}
	  \State $\lambda\gets $ result from a SciPy optimizer using functions \Call{objective-lambda}{} and \Call{objective-lambda-gradient}{}
	  \For{all n}
	  	\For{all i}
		  \State $\phi_{n,i}\gets e^{\lambda_i}\beta_{i, w_n}n_n$
		\EndFor
	  \EndFor
	  \State Normalize $\phi$ so that every row sums up to 1
      \State \Return $\phi$
      \EndFunction
   
      \Function{variational-inference}{$\mu$, $\Sigma$, $\beta$, $w$, $n$}
      \State Initialize the variational parameters: $\zeta=10, \phi=1, \lambda=0, \nu^2=1$
      \While{likelihood bound is changing}
      \State $\zeta\gets \Call{optimize-zeta}{\lambda, \nu^2}$
      \State $\lambda\gets \Call{optimize-lambda}{\zeta, \phi, \beta}$
      \State $\zeta\gets \Call{optimize-zeta}{\lambda, \nu^2}$
      \State $\nu^2\gets \Call{optimize-nu-sq}{\zeta, \lambda, \beta}$
      \State $\zeta\gets \Call{optimize-zeta}{\lambda, \nu^2}$      
      \State $\phi\gets \Call{optimize-phi}{\zeta, \lambda, \beta}$
      \EndWhile
    \State \Return ($\zeta, \phi, \lambda, \nu^2$)
    \EndFunction
\end{algorithmic}
\end{algorithm}
\end{document}